---
name: "Transcode"   # WF name in SWF
version: "1.0"      # WF version in SWF

input_spec:
  type: object

# Listing activities
activities:
- name: ValidateAsset         # Activity name in SWF
  version: "v2"
  input_spec:                 # JSON-Schema input validation
    type: object
    properties:
      input:
        type: object
    required:
      - input
  outputs_spec:
    metadata: "$.result"      # We output a `metadata` key that contains the input file metadata gathered by FFprobe

- name: TranscodeAsset        # Activity name in SWF
  version: "v2"
  input_spec:                 # JSON-Schema input validation
    type: object
    properties:
      input:
        type: object
      metadata:
        type: object
      output:
        type: object
    required:                 # Required input
    - input
    - metadata
    - output

# Listing Steps
steps:
- name: ValidateAssetStep
  activity: ValidateAsset
  input: |                    
    {
      "input": {{__input__.input}}
    }

- name: TranscodeAssetStep
  activity: TranscodeAsset
  requires:
  - [ValidateAssetStep, succeeded]
  input: |                    
    {
      "input": {{__input__.input}},
      "metadata": {{ValidateAssetStep.metadata}}
      "output": {{__input__.output}}
    }

